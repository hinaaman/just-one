"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.serve = exports.createAdaptorServer = void 0;
const node_http_1 = require("node:http");
const listener_1 = require("./listener");
const createAdaptorServer = (options) => {
    const fetchCallback = options.fetch;
    const requestListener = (0, listener_1.getRequestListener)(fetchCallback);
    const createServer = options.createServer || node_http_1.createServer;
    const server = createServer(options.serverOptions || {}, requestListener);
    return server;
};
exports.createAdaptorServer = createAdaptorServer;
const serve = (options, listeningListener) => {
    const server = (0, exports.createAdaptorServer)(options);
    server.listen(options?.port ?? 3000, options.hostname ?? '0.0.0.0', () => {
        const serverInfo = server.address();
        listeningListener && listeningListener(serverInfo);
    });
    return server;
};
exports.serve = serve;
